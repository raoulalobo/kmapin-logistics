//////////////////////////////////////////////////////////////////////////////////////////////
// DO NOT MODIFY THIS FILE                                                                  //
// This file is automatically generated by ZenStack CLI and should not be manually updated. //
//////////////////////////////////////////////////////////////////////////////////////////////

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider      = "prisma-client-js"
  output        = "../src/generated/prisma"
  binaryTargets = ["native", "rhel-openssl-3.0.x"]
}

enum UserRole {
  ADMIN
  OPERATIONS_MANAGER
  FINANCE_MANAGER
  CLIENT
  VIEWER
}

enum CargoType {
  GENERAL
  DANGEROUS
  PERISHABLE
  FRAGILE
  BULK
  CONTAINER
  PALLETIZED
  OTHER
}

enum TransportMode {
  ROAD
  SEA
  AIR
  RAIL
}

enum Priority {
  STANDARD
  EXPRESS
  URGENT
}

enum ShipmentStatus {
  DRAFT
  PENDING_APPROVAL
  APPROVED
  PICKED_UP
  IN_TRANSIT
  AT_CUSTOMS
  CUSTOMS_CLEARED
  OUT_FOR_DELIVERY
  READY_FOR_PICKUP
  DELIVERED
  CANCELLED
  ON_HOLD
  EXCEPTION
}

enum PickupStatus {
  REQUESTED
  SCHEDULED
  IN_PROGRESS
  COMPLETED
  CANCELED
}

enum PickupTimeSlot {
  MORNING
  AFTERNOON
  EVENING
  SPECIFIC_TIME
  FLEXIBLE
}

enum InvoiceStatus {
  DRAFT
  SENT
  VIEWED
  PAID
  OVERDUE
  CANCELLED
}

enum QuoteStatus {
  DRAFT
  SENT
  ACCEPTED
  REJECTED
  EXPIRED
}

enum ProspectStatus {
  PENDING
  CONVERTED
  EXPIRED
}

enum NotificationType {
  SHIPMENT_CREATED
  SHIPMENT_PICKED_UP
  SHIPMENT_IN_TRANSIT
  SHIPMENT_DELIVERED
  SHIPMENT_DELAYED
  INVOICE_GENERATED
  INVOICE_PAID
  QUOTE_REQUEST
  CUSTOMS_CLEARED
  DOCUMENT_UPLOADED
}

enum DocumentType {
  INVOICE_SCAN
  PROOF_OF_DELIVERY
  PROOF_OF_PICKUP
  PICKUP_SIGNATURE
  CUSTOMS_DOCUMENT
  PACKING_LIST
  BILL_OF_LADING
  CMR
  AIRWAY_BILL
  CERTIFICATE
  PHOTO
  OTHER
}

enum TransporterType {
  ROAD
  SEA
  AIR
  RAIL
  MULTIMODAL
}

model User {
  id                String          @id() @default(cuid())
  email             String          @unique()
  emailVerified     Boolean         @default(false)
  name              String?
  image             String?
  phone             String?
  createdAt         DateTime        @default(now())
  updatedAt         DateTime        @updatedAt()
  accounts          Account[]
  sessions          Session[]
  role              UserRole        @default(CLIENT)
  companyId         String?
  company           Company?        @relation(fields: [companyId], references: [id])
  permissions       Json?
  createdShipments  Shipment[]      @relation("CreatedBy")
  createdInvoices   Invoice[]       @relation("CreatedBy")
  uploadedDocuments Document[]      @relation("UploadedDocuments")
  prospect          Prospect?
  pricingConfigs    PricingConfig[]
  createdPickups    PickupRequest[] @relation("CreatedPickups")

  @@index([companyId])
  @@map("user")
}

model Account {
  id                    String    @id() @default(cuid())
  accountId             String
  providerId            String
  userId                String
  user                  User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  accessToken           String?
  refreshToken          String?
  idToken               String?
  accessTokenExpiresAt  DateTime?
  refreshTokenExpiresAt DateTime?
  scope                 String?
  password              String?
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt()

  @@unique([providerId, accountId])
  @@index([userId])
  @@map("account")
}

model Session {
  id        String   @id() @default(cuid())
  expiresAt DateTime
  token     String   @unique()
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt()
  ipAddress String?
  userAgent String?
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@map("session")
}

model VerificationToken {
  identifier String
  token      String   @unique()
  expires    DateTime

  @@unique([identifier, token])
}

model Verification {
  id         String   @id() @default(cuid())
  identifier String
  value      String
  expiresAt  DateTime
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt()

  @@index([identifier])
  @@map("verification")
}

model Company {
  id             String          @id() @default(cuid())
  name           String
  legalName      String?
  taxId          String?         @unique()
  email          String
  phone          String?
  address        String
  city           String
  postalCode     String?
  country        String
  website        String?
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt()
  users          User[]
  shipments      Shipment[]
  invoices       Invoice[]
  quotes         Quote[]
  documents      Document[]
  transporters   Transporter[]
  pickupRequests PickupRequest[]

  @@index([taxId])
}

model Shipment {
  id                    String          @id() @default(cuid())
  trackingNumber        String          @unique()
  companyId             String
  company               Company         @relation(fields: [companyId], references: [id])
  originAddress         String
  originCity            String
  originPostalCode      String
  originCountry         String
  originContact         String?
  originPhone           String?
  destinationAddress    String
  destinationCity       String
  destinationPostalCode String
  destinationCountry    String
  destinationContact    String?
  destinationPhone      String?
  cargoType             CargoType
  weight                Float
  length                Float?
  width                 Float?
  height                Float?
  packageCount          Int
  value                 Float?
  currency              String          @default("EUR")
  description           String
  specialInstructions   String?
  transportMode         TransportMode[]
  priority              Priority        @default(STANDARD)
  isDangerous           Boolean         @default(false)
  isFragile             Boolean         @default(false)
  requestedPickupDate   DateTime?
  actualPickupDate      DateTime?
  estimatedDeliveryDate DateTime?
  actualDeliveryDate    DateTime?
  status                ShipmentStatus  @default(DRAFT)
  estimatedCost         Float?
  actualCost            Float?
  invoiceId             String?         @unique()
  invoice               Invoice?        @relation(fields: [invoiceId], references: [id])
  createdById           String
  createdBy             User            @relation("CreatedBy", fields: [createdById], references: [id])
  createdAt             DateTime        @default(now())
  updatedAt             DateTime        @updatedAt()
  trackingEvents        TrackingEvent[]
  documents             Document[]
  pickupRequests        PickupRequest[]

  @@index([companyId])
  @@index([trackingNumber])
  @@index([status])
  @@index([createdAt])
}

model PickupRequest {
  id                  String         @id() @default(cuid())
  shipmentId          String
  shipment            Shipment       @relation(fields: [shipmentId], references: [id], onDelete: Cascade)
  pickupAddress       String
  pickupCity          String
  pickupPostalCode    String
  pickupCountry       String
  pickupContact       String?
  pickupPhone         String?
  requestedDate       DateTime
  scheduledDate       DateTime?
  timeSlot            PickupTimeSlot @default(FLEXIBLE)
  pickupTime          String?
  actualPickupDate    DateTime?
  status              PickupStatus   @default(REQUESTED)
  transporterId       String?
  transporter         Transporter?   @relation(fields: [transporterId], references: [id])
  driverName          String?
  driverPhone         String?
  vehiclePlate        String?
  specialInstructions String?
  accessInstructions  String?
  internalNotes       String?
  completionNotes     String?
  documents           Document[]
  notificationSent    Boolean        @default(false)
  reminderSent        Boolean        @default(false)
  confirmationSent    Boolean        @default(false)
  companyId           String
  company             Company        @relation(fields: [companyId], references: [id])
  createdById         String
  createdBy           User           @relation("CreatedPickups", fields: [createdById], references: [id])
  createdAt           DateTime       @default(now())
  updatedAt           DateTime       @updatedAt()

  @@index([shipmentId])
  @@index([companyId])
  @@index([status])
  @@index([scheduledDate])
  @@index([requestedDate])
  @@index([transporterId])
}

model TrackingEvent {
  id          String         @id() @default(cuid())
  shipmentId  String
  shipment    Shipment       @relation(fields: [shipmentId], references: [id], onDelete: Cascade)
  status      ShipmentStatus
  location    String
  latitude    Float?
  longitude   Float?
  description String?
  timestamp   DateTime       @default(now())
  metadata    Json?

  @@index([shipmentId])
  @@index([timestamp])
}

model Invoice {
  id            String        @id() @default(cuid())
  invoiceNumber String        @unique()
  companyId     String
  company       Company       @relation(fields: [companyId], references: [id])
  issueDate     DateTime      @default(now())
  dueDate       DateTime
  paidDate      DateTime?
  subtotal      Float
  taxRate       Float         @default(0)
  taxAmount     Float
  discount      Float         @default(0)
  total         Float
  currency      String        @default("EUR")
  status        InvoiceStatus @default(DRAFT)
  paymentMethod String?
  shipment      Shipment?
  quoteId       String?
  quote         Quote?        @relation(fields: [quoteId], references: [id])
  notes         String?
  createdById   String
  createdBy     User          @relation("CreatedBy", fields: [createdById], references: [id])
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt()
  items         InvoiceItem[]
  documents     Document[]

  @@index([companyId])
  @@index([status])
  @@index([invoiceNumber])
}

model InvoiceItem {
  id          String  @id() @default(cuid())
  invoiceId   String
  invoice     Invoice @relation(fields: [invoiceId], references: [id], onDelete: Cascade)
  description String
  quantity    Float
  unitPrice   Float
  amount      Float

  @@index([invoiceId])
}

model Quote {
  id                 String          @id() @default(cuid())
  quoteNumber        String          @unique()
  companyId          String
  company            Company         @relation(fields: [companyId], references: [id])
  originCountry      String
  destinationCountry String
  transportMode      TransportMode[]
  cargoType          CargoType
  weight             Float
  length             Float?
  width              Float?
  height             Float?
  estimatedCost      Float
  validUntil         DateTime
  currency           String          @default("EUR")
  status             QuoteStatus     @default(DRAFT)
  acceptedAt         DateTime?
  rejectedAt         DateTime?
  invoices           Invoice[]
  documents          Document[]
  convertedFromGuest GuestQuote?     @relation("ConvertedFromGuest")
  createdAt          DateTime        @default(now())
  updatedAt          DateTime        @updatedAt()

  @@index([companyId])
  @@index([status])
}

model Prospect {
  id                  String         @id() @default(cuid())
  email               String         @unique()
  phone               String?
  name                String?
  company             String?
  invitationToken     String         @unique() @default(cuid())
  invitationExpiresAt DateTime
  status              ProspectStatus @default(PENDING)
  userId              String?        @unique()
  user                User?          @relation(fields: [userId], references: [id])
  guestQuotes         GuestQuote[]
  createdAt           DateTime       @default(now())
  updatedAt           DateTime       @updatedAt()

  @@index([email])
  @@index([invitationToken])
  @@index([status])
}

model GuestQuote {
  id                 String          @id() @default(cuid())
  quoteNumber        String          @unique()
  prospectId         String
  prospect           Prospect        @relation(fields: [prospectId], references: [id], onDelete: Cascade)
  originCountry      String
  destinationCountry String
  transportMode      TransportMode[]
  cargoType          CargoType
  weight             Float
  length             Float?
  width              Float?
  height             Float?
  estimatedCost      Float
  validUntil         DateTime
  currency           String          @default("EUR")
  convertedToQuoteId String?         @unique()
  convertedToQuote   Quote?          @relation("ConvertedFromGuest", fields: [convertedToQuoteId], references: [id])
  createdAt          DateTime        @default(now())
  updatedAt          DateTime        @updatedAt()

  @@index([prospectId])
  @@index([quoteNumber])
}

model Notification {
  id        String           @id() @default(cuid())
  userId    String
  type      NotificationType
  title     String
  message   String
  data      Json?
  isRead    Boolean          @default(false)
  createdAt DateTime         @default(now())

  @@index([userId])
  @@index([isRead])
}

model Document {
  id              String         @id() @default(cuid())
  name            String
  fileUrl         String
  fileKey         String
  fileSize        Int
  mimeType        String
  type            DocumentType
  description     String?
  shipmentId      String?
  shipment        Shipment?      @relation(fields: [shipmentId], references: [id], onDelete: Cascade)
  invoiceId       String?
  invoice         Invoice?       @relation(fields: [invoiceId], references: [id], onDelete: Cascade)
  quoteId         String?
  quote           Quote?         @relation(fields: [quoteId], references: [id], onDelete: Cascade)
  pickupRequestId String?
  pickupRequest   PickupRequest? @relation(fields: [pickupRequestId], references: [id], onDelete: Cascade)
  companyId       String
  company         Company        @relation(fields: [companyId], references: [id])
  uploadedBy      String
  uploader        User           @relation("UploadedDocuments", fields: [uploadedBy], references: [id])
  uploadedAt      DateTime       @default(now())

  @@index([companyId])
  @@index([shipmentId])
  @@index([invoiceId])
  @@index([quoteId])
  @@index([pickupRequestId])
  @@index([uploadedBy])
}

model Transporter {
  id             String          @id() @default(cuid())
  name           String
  type           TransporterType
  email          String          @unique()
  phone          String
  address        String?
  city           String?
  postalCode     String?
  country        String?
  website        String?
  contactPerson  String?
  taxId          String?
  iban           String?
  notes          String?
  isActive       Boolean         @default(true)
  rating         Float?          @default(0)
  companyId      String
  company        Company         @relation(fields: [companyId], references: [id])
  pickupRequests PickupRequest[]
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt()

  @@index([companyId])
  @@index([type])
  @@map("transporter")
}

model PricingConfig {
  id                         String   @id() @default(cuid())
  baseRatePerKg              Float    @default(0.5)
  defaultRatePerKg           Float    @default(1.0)
  defaultRatePerM3           Float    @default(200.0)
  transportMultipliers       Json
  cargoTypeSurcharges        Json
  prioritySurcharges         Json
  deliverySpeedsPerMode      Json
  volumetricWeightRatios     Json     @default("{\"AIR\":167,\"ROAD\":333,\"SEA\":1,\"RAIL\":250}")
  useVolumetricWeightPerMode Json     @default("{\"AIR\":true,\"ROAD\":true,\"SEA\":false,\"RAIL\":true}")
  updatedById                String
  updatedBy                  User     @relation(fields: [updatedById], references: [id])
  createdAt                  DateTime @default(now())
  updatedAt                  DateTime @updatedAt()

  @@map("pricing_config")
}

model CountryDistance {
  id                 String   @id() @default(cuid())
  originCountry      String
  destinationCountry String
  distanceKm         Int
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt()

  @@unique([originCountry, destinationCountry])
  @@index([originCountry])
  @@index([destinationCountry])
  @@map("country_distance")
}

model TransportRate {
  id                     String        @id() @default(cuid())
  originCountryCode      String
  destinationCountryCode String
  transportMode          TransportMode
  ratePerKg              Float
  ratePerM3              Float
  cargoTypeSurcharges    Json?
  prioritySurcharges     Json?
  isActive               Boolean       @default(true)
  notes                  String?
  createdAt              DateTime      @default(now())
  updatedAt              DateTime      @updatedAt()

  @@unique([originCountryCode, destinationCountryCode, transportMode])
  @@index([originCountryCode])
  @@index([destinationCountryCode])
  @@index([transportMode])
  @@index([isActive])
  @@map("transport_rate")
}

model Country {
  id        String   @id() @default(cuid())
  code      String   @unique()
  name      String
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt()

  @@index([code])
  @@index([isActive])
  @@map("country")
}
