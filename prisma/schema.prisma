//////////////////////////////////////////////////////////////////////////////////////////////
// DO NOT MODIFY THIS FILE                                                                  //
// This file is automatically generated by ZenStack CLI and should not be manually updated. //
//////////////////////////////////////////////////////////////////////////////////////////////

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider      = "prisma-client-js"
  output        = "../src/generated/prisma"
  binaryTargets = ["native", "rhel-openssl-3.0.x"]
}

enum UserRole {
  ADMIN
  OPERATIONS_MANAGER
  FINANCE_MANAGER
  CLIENT
  VIEWER
}

enum CargoType {
  GENERAL
  DANGEROUS
  PERISHABLE
  FRAGILE
  BULK
  CONTAINER
  PALLETIZED
  OTHER
}

enum TransportMode {
  ROAD
  SEA
  AIR
  RAIL
}

enum Priority {
  STANDARD
  EXPRESS
  URGENT
}

enum ShipmentStatus {
  DRAFT
  PENDING_APPROVAL
  APPROVED
  PICKED_UP
  IN_TRANSIT
  AT_CUSTOMS
  CUSTOMS_CLEARED
  OUT_FOR_DELIVERY
  DELIVERED
  CANCELLED
  ON_HOLD
  EXCEPTION
}

enum InvoiceStatus {
  DRAFT
  SENT
  VIEWED
  PAID
  OVERDUE
  CANCELLED
}

enum QuoteStatus {
  DRAFT
  SENT
  ACCEPTED
  REJECTED
  EXPIRED
}

enum NotificationType {
  SHIPMENT_CREATED
  SHIPMENT_PICKED_UP
  SHIPMENT_IN_TRANSIT
  SHIPMENT_DELIVERED
  SHIPMENT_DELAYED
  INVOICE_GENERATED
  INVOICE_PAID
  QUOTE_REQUEST
  CUSTOMS_CLEARED
  DOCUMENT_UPLOADED
}

enum DocumentType {
  INVOICE_SCAN
  PROOF_OF_DELIVERY
  CUSTOMS_DOCUMENT
  PACKING_LIST
  BILL_OF_LADING
  CMR
  AIRWAY_BILL
  CERTIFICATE
  PHOTO
  OTHER
}

enum TransporterType {
  ROAD
  SEA
  AIR
  RAIL
  MULTIMODAL
}

model User {
  id                String     @id() @default(cuid())
  email             String     @unique()
  emailVerified     Boolean    @default(false)
  name              String?
  image             String?
  phone             String?
  createdAt         DateTime   @default(now())
  updatedAt         DateTime   @updatedAt()
  accounts          Account[]
  sessions          Session[]
  role              UserRole   @default(CLIENT)
  companyId         String?
  company           Company?   @relation(fields: [companyId], references: [id])
  permissions       Json?
  createdShipments  Shipment[] @relation("CreatedBy")
  createdInvoices   Invoice[]  @relation("CreatedBy")
  uploadedDocuments Document[] @relation("UploadedDocuments")

  @@index([companyId])
  @@map("user")
}

model Account {
  id                    String    @id() @default(cuid())
  accountId             String
  providerId            String
  userId                String
  user                  User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  accessToken           String?
  refreshToken          String?
  idToken               String?
  accessTokenExpiresAt  DateTime?
  refreshTokenExpiresAt DateTime?
  scope                 String?
  password              String?
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt()

  @@unique([providerId, accountId])
  @@index([userId])
  @@map("account")
}

model Session {
  id        String   @id() @default(cuid())
  expiresAt DateTime
  token     String   @unique()
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt()
  ipAddress String?
  userAgent String?
  userId    String
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@map("session")
}

model VerificationToken {
  identifier String
  token      String   @unique()
  expires    DateTime

  @@unique([identifier, token])
}

model Verification {
  id         String   @id() @default(cuid())
  identifier String
  value      String
  expiresAt  DateTime
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt()

  @@index([identifier])
  @@map("verification")
}

model Company {
  id           String        @id() @default(cuid())
  name         String
  legalName    String?
  taxId        String?       @unique()
  email        String
  phone        String?
  address      String
  city         String
  postalCode   String
  country      String
  website      String?
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt()
  users        User[]
  shipments    Shipment[]
  invoices     Invoice[]
  quotes       Quote[]
  documents    Document[]
  transporters Transporter[]

  @@index([taxId])
}

model Shipment {
  id                    String          @id() @default(cuid())
  trackingNumber        String          @unique()
  companyId             String
  company               Company         @relation(fields: [companyId], references: [id])
  originAddress         String
  originCity            String
  originPostalCode      String
  originCountry         String
  originContact         String?
  originPhone           String?
  destinationAddress    String
  destinationCity       String
  destinationPostalCode String
  destinationCountry    String
  destinationContact    String?
  destinationPhone      String?
  cargoType             CargoType
  weight                Float
  volume                Float?
  packageCount          Int
  value                 Float?
  currency              String          @default("EUR")
  description           String
  specialInstructions   String?
  transportMode         TransportMode[]
  priority              Priority        @default(STANDARD)
  isDangerous           Boolean         @default(false)
  isFragile             Boolean         @default(false)
  requestedPickupDate   DateTime?
  actualPickupDate      DateTime?
  estimatedDeliveryDate DateTime?
  actualDeliveryDate    DateTime?
  status                ShipmentStatus  @default(DRAFT)
  estimatedCost         Float?
  actualCost            Float?
  invoiceId             String?         @unique()
  invoice               Invoice?        @relation(fields: [invoiceId], references: [id])
  createdById           String
  createdBy             User            @relation("CreatedBy", fields: [createdById], references: [id])
  createdAt             DateTime        @default(now())
  updatedAt             DateTime        @updatedAt()
  trackingEvents        TrackingEvent[]
  documents             Document[]

  @@index([companyId])
  @@index([trackingNumber])
  @@index([status])
  @@index([createdAt])
}

model TrackingEvent {
  id          String         @id() @default(cuid())
  shipmentId  String
  shipment    Shipment       @relation(fields: [shipmentId], references: [id], onDelete: Cascade)
  status      ShipmentStatus
  location    String
  latitude    Float?
  longitude   Float?
  description String?
  timestamp   DateTime       @default(now())
  metadata    Json?

  @@index([shipmentId])
  @@index([timestamp])
}

model Invoice {
  id            String        @id() @default(cuid())
  invoiceNumber String        @unique()
  companyId     String
  company       Company       @relation(fields: [companyId], references: [id])
  issueDate     DateTime      @default(now())
  dueDate       DateTime
  paidDate      DateTime?
  subtotal      Float
  taxRate       Float         @default(0)
  taxAmount     Float
  discount      Float         @default(0)
  total         Float
  currency      String        @default("EUR")
  status        InvoiceStatus @default(DRAFT)
  paymentMethod String?
  shipment      Shipment?
  quoteId       String?
  quote         Quote?        @relation(fields: [quoteId], references: [id])
  notes         String?
  createdById   String
  createdBy     User          @relation("CreatedBy", fields: [createdById], references: [id])
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt()
  items         InvoiceItem[]
  documents     Document[]

  @@index([companyId])
  @@index([status])
  @@index([invoiceNumber])
}

model InvoiceItem {
  id          String  @id() @default(cuid())
  invoiceId   String
  invoice     Invoice @relation(fields: [invoiceId], references: [id], onDelete: Cascade)
  description String
  quantity    Float
  unitPrice   Float
  amount      Float

  @@index([invoiceId])
}

model Quote {
  id                 String          @id() @default(cuid())
  quoteNumber        String          @unique()
  companyId          String
  company            Company         @relation(fields: [companyId], references: [id])
  originCountry      String
  destinationCountry String
  transportMode      TransportMode[]
  cargoType          CargoType
  weight             Float
  volume             Float?
  estimatedCost      Float
  validUntil         DateTime
  currency           String          @default("EUR")
  status             QuoteStatus     @default(DRAFT)
  acceptedAt         DateTime?
  rejectedAt         DateTime?
  invoices           Invoice[]
  documents          Document[]
  createdAt          DateTime        @default(now())
  updatedAt          DateTime        @updatedAt()

  @@index([companyId])
  @@index([status])
}

model Notification {
  id        String           @id() @default(cuid())
  userId    String
  type      NotificationType
  title     String
  message   String
  data      Json?
  isRead    Boolean          @default(false)
  createdAt DateTime         @default(now())

  @@index([userId])
  @@index([isRead])
}

model Document {
  id          String       @id() @default(cuid())
  name        String
  fileUrl     String
  fileKey     String
  fileSize    Int
  mimeType    String
  type        DocumentType
  description String?
  shipmentId  String?
  shipment    Shipment?    @relation(fields: [shipmentId], references: [id], onDelete: Cascade)
  invoiceId   String?
  invoice     Invoice?     @relation(fields: [invoiceId], references: [id], onDelete: Cascade)
  quoteId     String?
  quote       Quote?       @relation(fields: [quoteId], references: [id], onDelete: Cascade)
  companyId   String
  company     Company      @relation(fields: [companyId], references: [id])
  uploadedBy  String
  uploader    User         @relation("UploadedDocuments", fields: [uploadedBy], references: [id])
  uploadedAt  DateTime     @default(now())

  @@index([companyId])
  @@index([shipmentId])
  @@index([invoiceId])
  @@index([quoteId])
  @@index([uploadedBy])
}

model Transporter {
  id            String          @id() @default(cuid())
  name          String
  type          TransporterType
  email         String          @unique()
  phone         String
  address       String?
  city          String?
  postalCode    String?
  country       String?
  website       String?
  contactPerson String?
  taxId         String?
  iban          String?
  notes         String?
  isActive      Boolean         @default(true)
  rating        Float?          @default(0)
  companyId     String
  company       Company         @relation(fields: [companyId], references: [id])
  createdAt     DateTime        @default(now())
  updatedAt     DateTime        @updatedAt()

  @@index([companyId])
  @@index([type])
  @@map("transporter")
}
